class tt{constructor(u,l,i={}){this.container=u,this.apiEndpoint=l,this.currentPage=0,this.pageSize=i.pageSize||25;const a=Array.isArray(i.pageSizeOptions)&&i.pageSizeOptions.length?i.pageSizeOptions.slice():[10,25,50,100];if(a.includes(this.pageSize)||a.push(this.pageSize),this.pageSizeOptions=a.sort((d,h)=>d-h),this.hasNextPage=!1,this.pageSizeSelect=null,this.pageSizeSelectId=`table-page-size-${Math.random().toString(36).slice(2,7)}`,this.paginationInfoElement=null,this.currentDisplayCount=0,this.params={skip:0,limit:this.pageSize,sort:i.defaultSort||"endedAt,desc",startedAt:null,endedAt:null,method:null,name:null,elapsed:null},i.initialFilters&&Object.entries(i.initialFilters).forEach(([d,h])=>{this.params[d]=h}),this.columns=i.columns||[],this.onRowClick=i.onRowClick,this.currentSortField=null,this.currentSortDir=null,this.params.sort){const[d,h]=this.params.sort.split(",");this.currentSortField=d,this.currentSortDir=h}this.init()}async init(){this.render(),await this.loadData()}async loadData(){try{const u=new URLSearchParams,l=this.params.limit+1;Object.entries({...this.params,limit:l}).forEach(([w,v])=>{v!=null&&u.append(w,v)});const i=new URL(this.apiEndpoint,window.location.origin);i.search=u.toString();const a=await fetch(i);if(!a.ok){const w=a.statusText?` ${a.statusText}`:"";throw new Error(`HTTP ${a.status}${w}`)}const d=await a.json(),h=d.measurements||d;this.hasNextPage=h.length>this.pageSize;const y=this.hasNextPage?h.slice(0,this.pageSize):h;this.currentDisplayCount=y.length,this.updateTable(y),this.updatePagination()}catch(u){console.error("Failed to load table data:",u)}}render(){this.container.innerHTML=`
      <div class="table-controls">
        <div class="table-filters"></div>
        <div class="table-pagination-info"></div>
      </div>
      <div class="table-container">
        <table class="server-table">
          <thead></thead>
          <tbody></tbody>
        </table>
      </div>
      <div class="table-pagination"></div>
    `,this.paginationInfoElement=this.container.querySelector(".table-pagination-info"),this.renderPageSizeControl(),this.renderHeaders()}renderPageSizeControl(){const u=this.container.querySelector(".table-filters")||this.container.querySelector(".table-controls");if(!u)return;const l=document.createElement("div");l.className="table-page-size";const i=document.createElement("label");i.className="filter-label",i.setAttribute("for",this.pageSizeSelectId),i.textContent="Rows per page";const a=document.createElement("select");a.className="filter-input table-page-size__select",a.id=this.pageSizeSelectId,a.setAttribute("aria-label","Rows per page"),this.pageSizeOptions.forEach(d=>{const h=document.createElement("option");h.value=d,h.textContent=d,a.appendChild(h)}),a.value=this.pageSize,a.addEventListener("change",d=>{const h=parseInt(d.target.value,10);Number.isNaN(h)||this.changePageSize(h)}),l.appendChild(i),l.appendChild(a),u.appendChild(l),this.pageSizeSelect=a}renderHeaders(){const u=this.container.querySelector("thead"),l=document.createElement("tr");this.columns.forEach(i=>{const a=document.createElement("th");a.textContent=i.label,i.sortable!==!1&&(a.classList.add("sortable"),a.dataset.field=i.field,i.field===this.currentSortField&&a.classList.add(`sort-${this.currentSortDir}`),a.addEventListener("click",()=>this.sort(i.field))),l.appendChild(a)}),u.appendChild(l)}updateTable(u){const l=this.container.querySelector("tbody");if(l.innerHTML="",u.length===0){const i=document.createElement("tr"),a=document.createElement("td");a.colSpan=this.columns.length,a.textContent="No data available",a.style.textAlign="center",a.style.padding="var(--spacing-lg)",a.style.color="var(--color-text-muted)",i.appendChild(a),l.appendChild(i);return}u.forEach(i=>{const a=document.createElement("tr");this.columns.forEach(d=>{const h=document.createElement("td");if(d.render){const y=d.render(i[d.field],i);y instanceof Node?h.appendChild(y):h.textContent=String(y)}else h.textContent=String(i[d.field]??"");a.appendChild(h)}),this.onRowClick&&(a.classList.add("clickable"),a.addEventListener("click",()=>this.onRowClick(i))),l.appendChild(a)})}sort(u){const l=this.currentSortField===u&&this.currentSortDir==="asc"?"desc":"asc";this.params.sort=`${u},${l}`,this.params.skip=0,this.currentPage=0,this.currentSortField=u,this.currentSortDir=l,this.container.querySelectorAll("th.sortable").forEach(i=>{i.classList.remove("sort-asc","sort-desc"),i.dataset.field===u&&i.classList.add(`sort-${l}`)}),this.loadData()}paginate(u){this.currentPage=u,this.params.skip=u*this.pageSize,this.loadData()}changePageSize(u){u!==this.pageSize&&(this.pageSize=u,this.params.limit=u,this.params.skip=0,this.currentPage=0,this.loadData())}async filter(u){return Object.entries(u).forEach(([l,i])=>{this.params[l]=i===void 0?null:i}),this.params.skip=0,this.currentPage=0,this.loadData()}updatePagination(){const u=this.container.querySelector(".table-pagination"),l=this.currentDisplayCount>0,i=l?this.currentPage*this.pageSize+1:0,a=l?i+this.currentDisplayCount-1:0;if(this.paginationInfoElement&&(this.paginationInfoElement.textContent=l?`Showing ${i}-${a}`:""),!l){u.textContent="";return}if(this.currentPage===0&&!this.hasNextPage){u.textContent="";return}let d='<div class="pagination">';this.currentPage>0&&(d+=`<button data-page="${this.currentPage-1}">Previous</button>`),d+=`<span class="page-info">Showing ${i}-${a}</span>`,this.hasNextPage&&(d+=`<button data-page="${this.currentPage+1}">Next</button>`),d+="</div>",u.innerHTML=d,u.querySelectorAll("button").forEach(h=>{h.addEventListener("click",y=>{this.paginate(parseInt(y.target.dataset.page))})})}}var Q=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function K(C){return C&&C.__esModule&&Object.prototype.hasOwnProperty.call(C,"default")?C.default:C}var J={exports:{}};(function(C,u){(function(l,i){C.exports=i()})(Q,function(){var l=1e3,i=6e4,a=36e5,d="millisecond",h="second",y="minute",w="hour",v="day",H="week",M="month",R="quarter",O="year",P="date",q="Invalid Date",Z=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,V=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,B={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(s){var n=["th","st","nd","rd"],t=s%100;return"["+s+(n[(t-20)%10]||n[t]||n[0])+"]"}},F=function(s,n,t){var r=String(s);return!r||r.length>=n?s:""+Array(n+1-r.length).join(t)+s},G={s:F,z:function(s){var n=-s.utcOffset(),t=Math.abs(n),r=Math.floor(t/60),e=t%60;return(n<=0?"+":"-")+F(r,2,"0")+":"+F(e,2,"0")},m:function s(n,t){if(n.date()<t.date())return-s(t,n);var r=12*(t.year()-n.year())+(t.month()-n.month()),e=n.clone().add(r,M),o=t-e<0,c=n.clone().add(r+(o?-1:1),M);return+(-(r+(t-e)/(o?e-c:c-e))||0)},a:function(s){return s<0?Math.ceil(s)||0:Math.floor(s)},p:function(s){return{M,y:O,w:H,d:v,D:P,h:w,m:y,s:h,ms:d,Q:R}[s]||String(s||"").toLowerCase().replace(/s$/,"")},u:function(s){return s===void 0}},T="en",x={};x[T]=B;var W="$isDayjsObject",Y=function(s){return s instanceof j||!(!s||!s[W])},A=function s(n,t,r){var e;if(!n)return T;if(typeof n=="string"){var o=n.toLowerCase();x[o]&&(e=o),t&&(x[o]=t,e=o);var c=n.split("-");if(!e&&c.length>1)return s(c[0])}else{var p=n.name;x[p]=n,e=p}return!r&&e&&(T=e),e||!r&&T},m=function(s,n){if(Y(s))return s.clone();var t=typeof n=="object"?n:{};return t.date=s,t.args=arguments,new j(t)},f=G;f.l=A,f.i=Y,f.w=function(s,n){return m(s,{locale:n.$L,utc:n.$u,x:n.$x,$offset:n.$offset})};var j=function(){function s(t){this.$L=A(t.locale,null,!0),this.parse(t),this.$x=this.$x||t.x||{},this[W]=!0}var n=s.prototype;return n.parse=function(t){this.$d=function(r){var e=r.date,o=r.utc;if(e===null)return new Date(NaN);if(f.u(e))return new Date;if(e instanceof Date)return new Date(e);if(typeof e=="string"&&!/Z$/i.test(e)){var c=e.match(Z);if(c){var p=c[2]-1||0,g=(c[7]||"0").substring(0,3);return o?new Date(Date.UTC(c[1],p,c[3]||1,c[4]||0,c[5]||0,c[6]||0,g)):new Date(c[1],p,c[3]||1,c[4]||0,c[5]||0,c[6]||0,g)}}return new Date(e)}(t),this.init()},n.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},n.$utils=function(){return f},n.isValid=function(){return this.$d.toString()!==q},n.isSame=function(t,r){var e=m(t);return this.startOf(r)<=e&&e<=this.endOf(r)},n.isAfter=function(t,r){return m(t)<this.startOf(r)},n.isBefore=function(t,r){return this.endOf(r)<m(t)},n.$g=function(t,r,e){return f.u(t)?this[r]:this.set(e,t)},n.unix=function(){return Math.floor(this.valueOf()/1e3)},n.valueOf=function(){return this.$d.getTime()},n.startOf=function(t,r){var e=this,o=!!f.u(r)||r,c=f.p(t),p=function(k,b){var E=f.w(e.$u?Date.UTC(e.$y,b,k):new Date(e.$y,b,k),e);return o?E:E.endOf(v)},g=function(k,b){return f.w(e.toDate()[k].apply(e.toDate("s"),(o?[0,0,0,0]:[23,59,59,999]).slice(b)),e)},$=this.$W,S=this.$M,D=this.$D,_="set"+(this.$u?"UTC":"");switch(c){case O:return o?p(1,0):p(31,11);case M:return o?p(1,S):p(0,S+1);case H:var z=this.$locale().weekStart||0,L=($<z?$+7:$)-z;return p(o?D-L:D+(6-L),S);case v:case P:return g(_+"Hours",0);case w:return g(_+"Minutes",1);case y:return g(_+"Seconds",2);case h:return g(_+"Milliseconds",3);default:return this.clone()}},n.endOf=function(t){return this.startOf(t,!1)},n.$set=function(t,r){var e,o=f.p(t),c="set"+(this.$u?"UTC":""),p=(e={},e[v]=c+"Date",e[P]=c+"Date",e[M]=c+"Month",e[O]=c+"FullYear",e[w]=c+"Hours",e[y]=c+"Minutes",e[h]=c+"Seconds",e[d]=c+"Milliseconds",e)[o],g=o===v?this.$D+(r-this.$W):r;if(o===M||o===O){var $=this.clone().set(P,1);$.$d[p](g),$.init(),this.$d=$.set(P,Math.min(this.$D,$.daysInMonth())).$d}else p&&this.$d[p](g);return this.init(),this},n.set=function(t,r){return this.clone().$set(t,r)},n.get=function(t){return this[f.p(t)]()},n.add=function(t,r){var e,o=this;t=Number(t);var c=f.p(r),p=function(S){var D=m(o);return f.w(D.date(D.date()+Math.round(S*t)),o)};if(c===M)return this.set(M,this.$M+t);if(c===O)return this.set(O,this.$y+t);if(c===v)return p(1);if(c===H)return p(7);var g=(e={},e[y]=i,e[w]=a,e[h]=l,e)[c]||1,$=this.$d.getTime()+t*g;return f.w($,this)},n.subtract=function(t,r){return this.add(-1*t,r)},n.format=function(t){var r=this,e=this.$locale();if(!this.isValid())return e.invalidDate||q;var o=t||"YYYY-MM-DDTHH:mm:ssZ",c=f.z(this),p=this.$H,g=this.$m,$=this.$M,S=e.weekdays,D=e.months,_=e.meridiem,z=function(b,E,N,I){return b&&(b[E]||b(r,o))||N[E].slice(0,I)},L=function(b){return f.s(p%12||12,b,"0")},k=_||function(b,E,N){var I=b<12?"AM":"PM";return N?I.toLowerCase():I};return o.replace(V,function(b,E){return E||function(N){switch(N){case"YY":return String(r.$y).slice(-2);case"YYYY":return f.s(r.$y,4,"0");case"M":return $+1;case"MM":return f.s($+1,2,"0");case"MMM":return z(e.monthsShort,$,D,3);case"MMMM":return z(D,$);case"D":return r.$D;case"DD":return f.s(r.$D,2,"0");case"d":return String(r.$W);case"dd":return z(e.weekdaysMin,r.$W,S,2);case"ddd":return z(e.weekdaysShort,r.$W,S,3);case"dddd":return S[r.$W];case"H":return String(p);case"HH":return f.s(p,2,"0");case"h":return L(1);case"hh":return L(2);case"a":return k(p,g,!0);case"A":return k(p,g,!1);case"m":return String(g);case"mm":return f.s(g,2,"0");case"s":return String(r.$s);case"ss":return f.s(r.$s,2,"0");case"SSS":return f.s(r.$ms,3,"0");case"Z":return c}return null}(b)||c.replace(":","")})},n.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},n.diff=function(t,r,e){var o,c=this,p=f.p(r),g=m(t),$=(g.utcOffset()-this.utcOffset())*i,S=this-g,D=function(){return f.m(c,g)};switch(p){case O:o=D()/12;break;case M:o=D();break;case R:o=D()/3;break;case H:o=(S-$)/6048e5;break;case v:o=(S-$)/864e5;break;case w:o=S/a;break;case y:o=S/i;break;case h:o=S/l;break;default:o=S}return e?o:f.a(o)},n.daysInMonth=function(){return this.endOf(M).$D},n.$locale=function(){return x[this.$L]},n.locale=function(t,r){if(!t)return this.$L;var e=this.clone(),o=A(t,r,!0);return o&&(e.$L=o),e},n.clone=function(){return f.w(this.$d,this)},n.toDate=function(){return new Date(this.valueOf())},n.toJSON=function(){return this.isValid()?this.toISOString():null},n.toISOString=function(){return this.$d.toISOString()},n.toString=function(){return this.$d.toUTCString()},s}(),U=j.prototype;return m.prototype=U,[["$ms",d],["$s",h],["$m",y],["$H",w],["$W",v],["$M",M],["$y",O],["$D",P]].forEach(function(s){U[s[1]]=function(n){return this.$g(n,s[0],s[1])}}),m.extend=function(s,n){return s.$i||(s(n,j,m),s.$i=!0),m},m.locale=A,m.isDayjs=Y,m.unix=function(s){return m(1e3*s)},m.en=x[T],m.Ls=x,m.p={},m})})(J);var X=J.exports;const et=K(X);export{tt as S,Q as c,et as d,K as g};
